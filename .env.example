# People Counter Configuration
# Copy this file to .env and fill in your values

# === Stream Mode: local | vps ===
# local = camera/RTSP as now (MJPEG from backend).
# vps  = no camera access; playback from VPS (HLS/WebRTC only). Camera pushes RTMP to VPS.
# STREAM_MODE=local
# Or with app prefix: PC_STREAM_MODE=local

# === Camera Settings (used when STREAM_MODE=local) ===
# OpenCV camera index for local webcam (default: 0)
PC_CAMERA_INDEX=0

# Dahua IP Camera (RTSP)
# Логин/пароль камеры (для MediaMTX и админки)
PC_DAHUA_USERNAME=admin
PC_DAHUA_PASSWORD=your_camera_password_here
# Адрес камеры, доступный С СЕРВЕРА: локальный IP, белый IP дома (проброс порта) или VPN IP
CAMERA_IP=192.168.0.201
CAMERA_PORT=554
DAHUA_USERNAME=admin
DAHUA_PASSWORD=your_camera_password_here

# === VPS stream (only when STREAM_MODE=vps) ===
# Camera pushes RTMP to VPS (e.g. MediaMTX). We only consume HLS/WebRTC; no camera access.
# VPS_HLS_URL    = HLS playlist URL, e.g. http://<vps-host>:8888/<path>/index.m3u8
# VPS_WEBRTC_URL = WebRTC (WHEP) base URL, e.g. http://<vps-host>:8889/<path>  (app will use /whep)
# STREAM_PREFERRED_PROTOCOL = webrtc | hls
# VPS_HLS_URL=http://your-vps:8888/dahua/index.m3u8
# VPS_WEBRTC_URL=http://your-vps:8889/dahua
# STREAM_PREFERRED_PROTOCOL=webrtc
# Set to true to count line crossings from HLS in VPS mode (needs ~2GB RAM for YOLO). Default false to avoid OOM.
# VPS_ANALYSIS_ENABLED=true

# === YOLO Model Settings ===
PC_MODEL_NAME=yolov8n.pt
PC_CONF_THRESHOLD=0.3
PC_IOU_THRESHOLD=0.5

# === Line Crossing Settings ===
# X position of vertical counting line (None = center of frame)
# PC_LINE_X=480
PC_HYSTERESIS_PX=5
PC_DIRECTION_IN=L->R

# === Video Processing ===
# Resize width for faster processing (e.g., 960)
# PC_RESIZE_WIDTH=960

# === Server Settings ===
PC_HOST=0.0.0.0
PC_PORT=8000

# === Docker full stack (docker-compose.full.yml / docker-compose.prod.yml) ===
# Эти переменные нужны для Postgres и для backend. PC_DB_URL в .env не задаётся —
# он собирается в docker-compose из POSTGRES_* и передаётся в контейнер backend.
POSTGRES_USER=people_counter
POSTGRES_PASSWORD=set_strong_password_here
POSTGRES_DB=people_counter_db
# Если запускаешь backend без compose и подключаешь свой Postgres, задай вручную:
# PC_DB_URL=postgresql://USER:PASSWORD@HOST:5432/DATABASE

# Публичный URL бэкенда (для запросов из браузера). Админка и аналитика будут слать запросы сюда.
VITE_API_URL=http://YOUR_SERVER_IP:8000

# Разрешённые CORS origins (через запятую). Укажите URL админки и аналитики с вашего сервера.
# CORS_ORIGINS=http://45.144.222.57:3000,http://45.144.222.57:3001

# === Logging ===
# Level: DEBUG, INFO, WARNING, ERROR. Logs go to stderr (visible in docker logs).
# PC_LOG_LEVEL=INFO
# LOG_LEVEL=DEBUG

# === Debug Settings ===
# Show OpenCV debug window (set to false for headless/production)
PC_SHOW_DEBUG_WINDOW=true

# Skip macOS camera permission dialog (for local dev)
# OPENCV_AVFOUNDATION_SKIP_AUTH=1
