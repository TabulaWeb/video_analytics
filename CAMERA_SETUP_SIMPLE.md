# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ IP –∫–∞–º–µ—Ä—ã Dahua –±–µ–∑ Docker

## –ë—ã—Å—Ç—Ä—ã–π —Å–ø–æ—Å–æ–± —á–µ—Ä–µ–∑ OpenCV (–±–µ–∑ Docker)

OpenCV —É–º–µ–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å RTSP –ø–æ—Ç–æ–∫–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é! –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 2 –º–∏–Ω—É—Ç—ã.

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –£–∑–Ω–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–º–µ—Ä—ã

–í–∞–º –Ω—É–∂–Ω–æ:
- **IP –∞–¥—Ä–µ—Å** –∫–∞–º–µ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: `192.168.0.200`)
- **–õ–æ–≥–∏–Ω** (–æ–±—ã—á–Ω–æ: `admin`)
- **–ü–∞—Ä–æ–ª—å** –æ—Ç –∫–∞–º–µ—Ä—ã

### –®–∞–≥ 2: –°—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ RTSP URL

–§–æ—Ä–º–∞—Ç –¥–ª—è Dahua –∫–∞–º–µ—Ä:
```
rtsp://–ª–æ–≥–∏–Ω:–ø–∞—Ä–æ–ª—å@IP:554/cam/realmonitor?channel=1&subtype=0
```

**–ü—Ä–∏–º–µ—Ä:**
```
rtsp://admin:mypassword123@192.168.0.200:554/cam/realmonitor?channel=1&subtype=0
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `subtype=0` ‚Äî main stream (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, ~1080p)
- `subtype=1` ‚Äî sub stream (–Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, ~360p, –º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞)

### –®–∞–≥ 3: –£–∫–∞–∂–∏—Ç–µ RTSP URL –≤ `.env`

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –∑–∞–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É `PC_CAMERA_INDEX=0` –Ω–∞ –≤–∞—à RTSP URL:

```bash
# –ë—ã–ª–æ (–≤–µ–±-–∫–∞–º–µ—Ä–∞):
PC_CAMERA_INDEX=0

# –°—Ç–∞–ª–æ (IP –∫–∞–º–µ—Ä–∞):
PC_CAMERA_INDEX=rtsp://admin:mypassword123@192.168.0.200:554/cam/realmonitor?channel=1&subtype=0
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:** 
- –ó–∞–º–µ–Ω–∏—Ç–µ `mypassword123` –Ω–∞ –≤–∞—à —Ä–µ–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å
- –ó–∞–º–µ–Ω–∏—Ç–µ `192.168.0.200` –Ω–∞ IP –≤–∞—à–µ–π –∫–∞–º–µ—Ä—ã (–µ—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è)
- –ü–∞—Ä–æ–ª—å –±—É–¥–µ—Ç –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ –≤ `.env`, –Ω–æ —Ñ–∞–π–ª –≤ `.gitignore` (–Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ git)

### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å (Ctrl+C –∏–ª–∏)
pkill -9 -f "run.py"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ
cd /Users/alextabula/Desktop/vision
.venv/bin/python run.py --no-debug-window
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000

**–í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** ‚Äî —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ—Ç–æ–∫ —Å IP –∫–∞–º–µ—Ä—ã!

## ‚úÖ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
- ‚úÖ –ü–æ–ª—É—á–∞–µ—Ç –≤–∏–¥–µ–æ –Ω–∞–ø—Ä—è–º—É—é —Å IP –∫–∞–º–µ—Ä—ã —á–µ—Ä–µ–∑ RTSP
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ YOLO + ByteTrack
- ‚úÖ –°—á–∏—Ç–∞–µ—Ç –ª—é–¥–µ–π, –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö –ª–∏–Ω–∏—é
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

**–ù–∏–∫–∞–∫–æ–≥–æ Docker –Ω–µ –Ω—É–∂–Ω–æ!** üéâ

## üîß –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –≤–µ–±-–∫–∞–º–µ—Ä—É

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≤–µ–±-–∫–∞–º–µ—Ä—É:

```bash
# –í .env –∏–∑–º–µ–Ω–∏—Ç–µ –Ω–∞:
PC_CAMERA_INDEX=0
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

## üÜò Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Failed to open camera"

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π IP –∞–¥—Ä–µ—Å –∫–∞–º–µ—Ä—ã
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å
3. RTSP –ø–æ—Ä—Ç (554) –∑–∞–∫—Ä—ã—Ç –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
4. –ö–∞–º–µ—Ä–∞ –Ω–µ –≤ —Ç–æ–π –∂–µ —Å–µ—Ç–∏

**–†–µ—à–µ–Ω–∏—è:**

#### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞–º–µ—Ä—ã
```bash
ping 192.168.0.200
```

–ï—Å–ª–∏ –ø–∏–Ω–≥ –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- IP –∞–¥—Ä–µ—Å –∫–∞–º–µ—Ä—ã (–∑–∞–π–¥–∏—Ç–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–º–µ—Ä—ã)
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ç–æ–π –∂–µ —Å–µ—Ç–∏

#### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RTSP —á–µ—Ä–µ–∑ VLC
1. –û—Ç–∫—Ä–æ–π—Ç–µ VLC Media Player
2. `Media` ‚Üí `Open Network Stream`
3. –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à RTSP URL
4. –ù–∞–∂–º–∏—Ç–µ `Play`

–ï—Å–ª–∏ –≤–∏–¥–µ–æ –∏–≥—Ä–∞–µ—Ç—Å—è –≤ VLC ‚Äî –∑–Ω–∞—á–∏—Ç URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!

#### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ RTSP –Ω–∞ –∫–∞–º–µ—Ä–µ
1. –ó–∞–π–¥–∏—Ç–µ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–∞–º–µ—Ä—ã (http://192.168.0.200)
2. `Setup` ‚Üí `Network` ‚Üí `Port`
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ **RTSP Port = 554** –∏ –≤–∫–ª—é—á–µ–Ω

#### 4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ sub stream (–º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞)
```bash
# –ó–∞–º–µ–Ω–∏—Ç–µ subtype=0 –Ω–∞ subtype=1
PC_CAMERA_INDEX=rtsp://admin:password@192.168.0.200:554/cam/realmonitor?channel=1&subtype=1
```

### –ü—Ä–æ–±–ª–µ–º–∞: –í–∏–¥–µ–æ —Ç–æ—Ä–º–æ–∑–∏—Ç/–ª–∞–≥–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω—ã:**
- –í—ã—Å–æ–∫–∏–π –±–∏—Ç—Ä–µ–π—Ç –∫–∞–º–µ—Ä—ã
- –°–ª–∞–±–∞—è —Å–µ—Ç—å (WiFi)
- –°–ª–∞–±—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä

**–†–µ—à–µ–Ω–∏—è:**

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ sub stream** (–º–µ–Ω—å—à–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ):
   ```bash
   PC_CAMERA_INDEX=rtsp://admin:password@192.168.0.200:554/cam/realmonitor?channel=1&subtype=1
   ```

2. **–£–≤–µ–ª–∏—á—å—Ç–µ resize_width** (–º–µ–Ω—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ YOLO):
   ```bash
   PC_RESIZE_WIDTH=640  # –í–º–µ—Å—Ç–æ 960
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å YOLO**:
   ```bash
   PC_MODEL_NAME=yolov8n.pt  # –°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è (—É–∂–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   ```

4. **–ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∫–∞–º–µ—Ä—É –ø–æ LAN** (–Ω–µ WiFi):
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ethernet –∫–∞–±–µ–ª—å –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ—Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–µ—Ç—å
- –¢–∞–π–º–∞—É—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RTSP –≤ URL:
```bash
PC_CAMERA_INDEX=rtsp://admin:password@192.168.0.200:554/cam/realmonitor?channel=1&subtype=0&tcp
```

–ü–∞—Ä–∞–º–µ—Ç—Ä `&tcp` –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TCP –≤–º–µ—Å—Ç–æ UDP (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ).

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë–µ–∑ Docker (OpenCV) | –° Docker (MediaMTX + HLS) |
|----------|---------------------|----------------------------|
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ | ‚≠ê –õ–µ–≥–∫–æ | ‚≠ê‚≠ê‚≠ê –°–ª–æ–∂–Ω–æ |
| –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è | OpenCV | Docker Desktop |
| –ó–∞–¥–µ—Ä–∂–∫–∞ | < 100ms | 2-5 —Å–µ–∫—É–Ω–¥ |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ | ‚úÖ –î–∞ (YOLO) | ‚ùå –ù–µ—Ç (—á–∏—Å—Ç–æ–µ –≤–∏–¥–µ–æ) |
| –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è |
| –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ | –û–±—Ä–∞–±–æ—Ç–∫–∞ + —Å—á–µ—Ç—á–∏–∫ | –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä |

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ (–¥–µ—Ç–µ–∫—Ü–∏—è, —Å—á–µ—Ç—á–∏–∫) ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–º–µ—Ç–æ–¥ –±–µ–∑ Docker** (OpenCV). –û–Ω –ø—Ä–æ—â–µ –∏ –±—ã—Å—Ç—Ä–µ–µ!

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ü–∞—Ä–æ–ª—å –æ—Ç –∫–∞–º–µ—Ä—ã –±—É–¥–µ—Ç –≤ —Ñ–∞–π–ª–µ `.env` –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ!

**–ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å:**

1. `.env` —É–∂–µ –≤ `.gitignore` ‚Äî –Ω–µ –ø–æ–ø–∞–¥–µ—Ç –≤ git ‚úÖ

2. –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É:
   ```bash
   chmod 600 .env
   ```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å** –Ω–∞ –∫–∞–º–µ—Ä–µ:
   - –ú–∏–Ω–∏–º—É–º 12 —Å–∏–º–≤–æ–ª–æ–≤
   - –ë—É–∫–≤—ã + —Ü–∏—Ñ—Ä—ã + —Å–∏–º–≤–æ–ª—ã
   - –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø–∞—Ä–æ–ª—å!

4. **–ù–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø–æ—Ä—Ç—ã** –∫–∞–º–µ—Ä—ã –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç:
   - –ö–∞–º–µ—Ä–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏
   - –î–ª—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ VPN

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –î—Ä—É–≥–∏–µ IP –∫–∞–º–µ—Ä—ã (–Ω–µ Dahua)

**Hikvision:**
```bash
PC_CAMERA_INDEX=rtsp://admin:password@192.168.0.200:554/Streaming/Channels/101
```

**TP-Link:**
```bash
PC_CAMERA_INDEX=rtsp://admin:password@192.168.0.200:554/stream1
```

**Generic ONVIF:**
```bash
PC_CAMERA_INDEX=rtsp://admin:password@192.168.0.200:554/onvif1
```

### HTTP/MJPEG –∫–∞–º–µ—Ä—ã

–ï—Å–ª–∏ –∫–∞–º–µ—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTTP MJPEG:
```bash
PC_CAMERA_INDEX=http://192.168.0.200/video.mjpg
```

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å IP –∫–∞–º–µ—Ä—É –±–µ–∑ Docker. –ü—Ä–æ—Å—Ç–æ –∏ –±—ã—Å—Ç—Ä–æ! üöÄ
